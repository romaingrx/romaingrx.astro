---
import { Icon } from 'astro-icon/components';
import { Image } from 'astro:assets';
import { type CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { data, id } = post;
const { title, description, image, published_date, authors, categories } = data;

// Format date
const formattedDate = new Date(published_date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<article
  class="group relative flex h-full flex-col overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300 hover:shadow-md"
  data-animate="fade-up"
>
  <a href={`/blog/${id}`} class="flex h-full flex-col">
    {
      image && (
        <div class="aspect-video w-full overflow-hidden">
          <Image
            src={image}
            alt={title}
            width={800}
            height={400}
            class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
        </div>
      )
    }
    <div class="flex flex-1 flex-col justify-between space-y-6 p-6">
      <div class="space-y-4">
        <div class="space-y-3">
          <h2
            class="line-clamp-2 text-xl font-semibold tracking-tight transition-colors group-hover:text-primary sm:text-2xl"
          >
            {title}
          </h2>
          {
            description && (
              <p class="line-clamp-3 text-sm leading-relaxed text-muted-foreground">
                {description}
              </p>
            )
          }
        </div>

        <div class="flex flex-wrap gap-2">
          {
            categories.map(category => (
              <span class="inline-flex items-center gap-1.5 rounded-md bg-muted px-2.5 py-0.5 text-xs font-medium text-muted-foreground transition-colors hover:text-foreground">
                <Icon name="lucide:folder" class="h-3.5 w-3.5" />
                {category}
              </span>
            ))
          }
        </div>
      </div>

      <div class="flex items-center justify-between border-t pt-4">
        <div class="flex items-center gap-2">
          {
            authors.map(author => (
              <span class="text-sm font-medium text-muted-foreground hover:text-foreground">
                {author}
              </span>
            ))
          }
        </div>
        <time datetime={published_date.toISOString()} class="text-sm text-muted-foreground">
          {formattedDate}
        </time>
      </div>
    </div>
  </a>
</article>
